import{_ as e,r as l,w as a,e as o,f as t,g as s,m as i,i as n,j as d,c as r,k as u,h as p,O as c,N as m,L as b,b as g,v as f,q as h,M as v,l as y,t as w,s as _,x as k}from"./index-68f4f231.js";import{u as C,a as V}from"./useCommon-97a7458f.js";import{t as N}from"./useTablePage-337a13be.js";const x={class:"dialog-footer"},S=g("Cancel"),T=g("Submit"),I=e({__name:"StockGoodsEditForm",emits:["selectPageReq","hideComp"],setup(e,{expose:g,emit:h}){let v=[{value:1,display:"Web2"},{value:2,display:"Web3"}],y=l({stockId:"",goodsName:"",brand:"",goodsImage:"",periodType:"",deviceType:"",count:"",currencyType:"",price:0,saleChannel:""});a((()=>y.saleChannel),(e=>{y.currencyType=e}));const w=l({label:"商品价格(Vcoin)",precision:0,max:1e3,step:1,min:1});a((()=>y.saleChannel),(e=>{2==e?(w.label="商品价格(以太币)",w.precision=5,w.max=1,w.step=1e-5,w.min=1e-5,y.price=0):(w.label="商品价格(Vcoin)",w.precision=0,w.max=1e3,w.step=1,w.min=1,y.price=0)}));const _=o(null);let k=()=>{_.value.validate((e=>{if(!e)return!1;j()}))};const{formRules:N,elMessage:I}=C();let j=()=>{const e=JSON.parse(JSON.stringify(y));return f({url:`/api/mall3/stock/${e.stockId}/shelve`,data:e,method:"post",bfLoading:!0,timeout:6e4}).then((()=>{I("商品上架成功"),h("selectPageReq"),h("hideComp")}))};const{dialogTitle:z,dialogVisible:O}=V();let U=()=>{h("hideComp")};return g({showModal:e=>{var l;z.value=`库存商品[${e.id}]上架`,O.value=!0,l=e,Object.keys(l).forEach((e=>{Object.keys(y).forEach((a=>{e===a&&(y[a]=l[a])}))}))}}),(e,l)=>{const a=t("el-input"),o=t("el-form-item"),g=t("el-image"),f=t("el-option"),h=t("el-select"),C=t("el-input-number"),V=t("el-form"),I=t("el-button"),j=t("el-dialog");return s(),i(j,{modelValue:u(O),"onUpdate:modelValue":l[5]||(l[5]=e=>b(O)?O.value=e:null),title:u(z),width:"60vw","close-on-click-modal":!1,"before-close":u(U)},{footer:n((()=>[d("span",x,[r(I,{onClick:u(U)},{default:n((()=>[S])),_:1},8,["onClick"]),r(I,{type:"primary",onClick:u(k)},{default:n((()=>[T])),_:1},8,["onClick"])])])),default:n((()=>[r(V,{ref_key:"refForm",ref:_,"label-width":"200px",inline:!1,model:u(y),rules:u(N),class:"pr-5"},{default:n((()=>[r(o,{label:"商品名称",prop:"goodsName",rules:u(N).isNotNull,"label-position":"left"},{default:n((()=>[r(a,{modelValue:u(y).goodsName,"onUpdate:modelValue":l[0]||(l[0]=e=>u(y).goodsName=e),"min-width":"300",placeholder:"商品名称"},null,8,["modelValue"])])),_:1},8,["rules"]),r(o,{label:"商品图片",prop:"goodsImage",rules:u(N).isNotNull,"label-position":"left"},{default:n((()=>[r(a,{modelValue:u(y).goodsImage,"onUpdate:modelValue":l[1]||(l[1]=e=>u(y).goodsImage=e),"min-width":"300",placeholder:"商品图片"},null,8,["modelValue"]),r(g,{style:{width:"70px",height:"70px"},src:u(y).goodsImage},null,8,["src"])])),_:1},8,["rules"]),r(o,{label:"销售渠道",prop:"saleChannel",rules:u(N).isNotNull,"label-position":"left"},{default:n((()=>[r(h,{modelValue:u(y).saleChannel,"onUpdate:modelValue":l[2]||(l[2]=e=>u(y).saleChannel=e),"min-width":"300",placeholder:"销售渠道"},{default:n((()=>[(s(!0),p(m,null,c(u(v),(e=>(s(),i(f,{key:e.value,label:e.display,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["rules"]),r(o,{label:w.label,prop:"price",rules:u(N).isNotNull,"label-position":"left"},{default:n((()=>[r(C,{modelValue:u(y).price,"onUpdate:modelValue":l[3]||(l[3]=e=>u(y).price=e),step:w.step,precision:w.precision,max:w.max,min:w.min,"step-strictly":""},null,8,["modelValue","step","precision","max","min"])])),_:1},8,["label","rules"]),r(o,{label:"上架库存",prop:"count",rules:u(N).isNotNull,"label-position":"left"},{default:n((()=>[r(C,{modelValue:u(y).count,"onUpdate:modelValue":l[4]||(l[4]=e=>u(y).count=e),precision:0,step:1,max:10,min:1,"step-strictly":""},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"])}}},[["__file","/Users/liuzhaoming/百度云同步盘/mac同步/project/valor/web3/mall/mall3-web/src/views/stock/goods/StockGoodsEditForm.vue"]]),j={class:"scroll-y"},z={class:"mr-3 rowSS"},O=g("查询"),U=g("上架"),P={class:"block columnCC mt-2"},F={name:"StockGoods"},J=e(Object.assign(F,{setup(e){const{elMessage:a}=C(),b=h();let V=o([]),x=l({periodType:"",deviceType:""}),S=[{value:0,display:"所有"},{value:1,display:"月卡(30天)"},{value:2,display:"年卡(365天)"}],T=e=>1===e?"月卡(30天)":"年卡(365天)",F=[{value:0,display:"所有"},{value:1,display:"个人(单设备)"},{value:2,display:"家庭(4设备)"}],J=e=>1===e?"个人(单设备)":"家庭(4设备)";v((()=>{E()}));let q=o(1),E=()=>{const e=Object.assign(x,{pageNumber:M.value-1,pageSize:R.value}),l=JSON.parse(JSON.stringify(e));Object.keys(l).forEach((e=>{""!==l[e]&&null!==l[e]&&void 0!==l[e]&&0!==l[e]||delete l[e]})),f({url:"/api/mall3/stock",method:"get",data:l,isParams:!0}).then((e=>{var l,a;V.value=null==(l=e.data)?void 0:l.content,q.value=null==(a=e.data)?void 0:a.total}))},{pageNum:M,pageSize:R,handleCurrentChange:G,handleSizeChange:L}=N(E);const W=()=>{M.value=1,E()};let $=o(!1);const H=o(null),A=()=>{$.value=!1};let B=e=>{if(!e.brand&&!b.brand)return void a("请先到【账号-我的】菜单中配置品牌","error");$.value=!0;const l=JSON.parse(JSON.stringify(e));l.goodsName=(l.brand||b.brand)+J(l.deviceType)+T(l.periodType),l.goodsImage=e.brandIcon||b.brandIcon,l.count=0,l.stockId=e.id,l.stockCount=e.count,k((()=>{H.value.showModal(l)}))};return(e,l)=>{const a=t("el-option"),o=t("el-select"),b=t("el-form-item"),f=t("el-form"),h=t("el-button"),v=t("el-table-column"),k=t("el-image"),C=t("el-table"),N=t("el-pagination");return s(),p("div",j,[y("操作"),d("div",z,[y("条件搜索"),r(f,{ref:"refsearchForm",inline:!0,class:"demo-searchForm ml-2"},{default:n((()=>[r(b,{"label-width":"0px",label:"",prop:"type","label-position":"left"},{default:n((()=>[r(o,{modelValue:u(x).deviceType,"onUpdate:modelValue":l[0]||(l[0]=e=>u(x).deviceType=e),class:"widthPx-150",placeholder:"设备类型"},{default:n((()=>[(s(!0),p(m,null,c(u(F),(e=>(s(),i(a,{key:e.value,label:e.display,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(b,{"label-width":"0px",label:"",prop:"type","label-position":"left"},{default:n((()=>[r(o,{modelValue:u(x).periodType,"onUpdate:modelValue":l[1]||(l[1]=e=>u(x).periodType=e),class:"widthPx-150",placeholder:"周期类型"},{default:n((()=>[(s(!0),p(m,null,c(u(S),(e=>(s(),i(a,{key:e.value,label:e.display,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},512),y("查询按钮"),r(h,{type:"primary",onClick:W},{default:n((()=>[O])),_:1})]),y("表格和分页"),r(C,{id:"mainTable",ref:"mainTable",height:`calc(100vh - ${u(_).delWindowHeight})`,border:"",data:u(V)},{default:n((()=>[r(v,{align:"center",prop:"id",label:"Id",width:"80"}),r(v,{align:"center",prop:"brand",label:"品牌",width:"140"}),r(v,{align:"center",prop:"brandIcon",label:"品牌Logo","min-width":"120"},{default:n((({row:e})=>[r(k,{style:{width:"80px",height:"80px"},src:e.brandIcon},null,8,["src"])])),_:1}),r(v,{align:"center",label:"设备类型",width:"140"},{default:n((({row:e})=>[g(w(u(J)(e.deviceType)),1)])),_:1}),r(v,{align:"center",label:"周期类型",width:"140"},{default:n((({row:e})=>[g(w(u(T)(e.periodType)),1)])),_:1}),r(v,{align:"center",prop:"count",label:"库存",width:"140"}),y("点击操作"),r(v,{fixed:"right",align:"center",label:"操作","min-width":"200"},{default:n((({row:e})=>[r(h,{link:"",size:"small",type:"primary",onClick:l=>u(B)(e)},{default:n((()=>[U])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["height","data"]),y("分页"),d("div",P,[r(N,{"current-page":u(M),"page-sizes":[10,20,50,100],"page-size":u(R),layout:"total, sizes, prev, pager, next, jumper",total:u(q),onSizeChange:u(L),onCurrentChange:u(G)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),u($)?(s(),i(I,{key:0,ref_key:"refShelveForm",ref:H,onHideComp:A,onSelectPageReq:u(E)},null,8,["onSelectPageReq"])):y("v-if",!0)])}}}),[["__scopeId","data-v-15eed468"],["__file","/Users/liuzhaoming/百度云同步盘/mac同步/project/valor/web3/mall/mall3-web/src/views/stock/goods/StockGoods.vue"]]);export{J as default};
